<div style="display: flex; flex-direction: column; gap: 20px; max-width: 100%;">

  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
    <div>
      <h2 style="margin: 0;">ğŸ“¡ Channels</h2>
      <p>Manage your communication channels</p>
    </div>

    <div style="display: flex; gap: 40px; align-items: center;">
      <a href="/apps/<%= app.id %>/channels/create" style="white-space: nowrap;">â• Create a new channel</a>
      <a href="/apps/<%= app.id %>/channels/import" style="white-space: nowrap;">â¬†ï¸ Import configs</a>
    </div>
  </div>

  <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;">

    <% if (app.channels.length) { %>
      <% app.channels.forEach(channel => { %>
        <div class="channel-card" style="border: dashed; border-radius: 5px; padding: 20px; display: flex; flex-direction: column; gap: 10px;">
          <div style="display: grid; grid-template-columns: auto minmax(0, 1fr); gap: 10px;">
            <div><strong>ğŸ·ï¸ ID:</strong></div>
            <div><%= channel.id %></div>

            <div><strong>ğŸ”¤ Name:</strong></div>
            <div style="word-break: break-all;"><%= channel.config.name %></div>

            <div><strong>ğŸ“¡ Type:</strong></div>
            <div><%= channel.channel_type === 'email' ? 'âœ‰ï¸ Email' : channel.channel_type === 'discord' ? 'ğŸ’¬ Discord' : 'ğŸ“± SMS' %></div>

            <div><strong>ğŸš¦ Status:</strong></div>
            <div
              style="
                height: fit-content;
                width: fit-content;
                padding: 0px 5px;
                border-radius: 5px;
                <%= channel.config.is_active ? 'color: green; border: 1px solid green;' : 'color: red; border: 1px solid red;' %>"
            >
              <%= channel.config.is_active ? 'ğŸŸ¢ Active' : 'ğŸ”´ Inactive' %>
            </div>

            <div><strong>ğŸ•’ Created:</strong></div>
            <div><%= channel.config.created_at %></div>

            <div><strong>ğŸ› ï¸ Updated:</strong></div>
            <div><%= channel.config.updated_at %></div>
          </div>

          <div style="display: flex; align-items: center; gap: 20px; flex-wrap: wrap;">
            <button class="no-style-btn" onclick="this.closest('.channel-card').querySelector('.details-content').toggleAttribute('hidden'); this.textContent = this.textContent.includes('â–¶') ? 'â–¼ ğŸ” Details' : 'â–¶ ğŸ” Details'">â–¶ ğŸ” Details</button>
            <a href="/apps/<%= app.id %>/channels/<%= channel.id %>/configs/<%= channel.config.id %>/edit">âœï¸ Edit</a>
            <button class="no-style-btn" onclick="document.getElementById(`delete-channels-<%= channel.id %>-modal`).showModal()">ğŸ—‘ï¸ Delete</button>
          </div>

          <div class="details-content" hidden style="margin-top: 10px; padding: 10px; border: 1px dashed; border-radius: 5px;">
            <% if (channel.channel_type === 'email') { %>
              <div style="display: grid; grid-template-columns: auto 1fr; gap: 5px 10px;">
                <div><strong>ğŸ“§ Email Host:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.host %></div>
                <div><strong>ğŸ“§ Email Port:</strong></div>
                <div><%= channel.config.port %></div>
                <div><strong>ğŸ‘¤ Email Alias:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.alias %></div>
                <div><strong>ğŸ”‘ Email Auth:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.auth_email %></div>
                <div><strong>ğŸ”’ Email Auth Pass:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.auth_pass %></div>
              </div>
            <% } %>

            <% if (channel.channel_type === 'discord') { %>
              <div style="display: grid; grid-template-columns: auto 1fr; gap: 5px 10px;">
                <div><strong>ğŸŒ Webhook URL:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.webhook_url %></div>
              </div>
            <% } %>

            <% if (channel.channel_type === 'sms') { %>
              <div style="display: grid; grid-template-columns: auto 1fr; gap: 5px 10px;">
                <div><strong>ğŸ“ Phone Number:</strong></div>
                <div><%= channel.config.phone_number %></div>
                <div><strong>ğŸ“² From Phone Number:</strong></div>
                <div><%= channel.config.from_phone_number %></div>
                <div><strong>ğŸ”‘ Account SID:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.account_sid %></div>
                <div><strong>ğŸ”’ Auth Token:</strong></div>
                <div style="word-break: break-all;"><%= channel.config.auth_token %></div>
              </div>
            <% } %>
          </div>
            <dialog id="delete-channels-<%= channel.id %>-modal">
              <h2>âš ï¸ Confirm Deletion</h2>
              <p>Are you sure you want to delete this channel?</p>
              <form method="POST" action="/apps/<%= app.id %>/channels/<%= channel.id %>/delete">
                <input type="hidden" id="csrfToken" name="csrfToken" value="<%= csrfToken %>" />

                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                  <button type="button" onclick="this.closest('dialog').close()">âŒ Cancel</button>
                  <button type="submit">ğŸ—‘ï¸ Delete</button>
                </div>
              </form>
            </dialog>
          </div>
        </div>
      <% }) %>
    <% } %>

    <% if (!app.channels.length) { %>
      <article style="border-style: dashed; padding: 20px; border-radius: 5px;">
        <p>ğŸ“­ There are no channels currently</p>
      </article>
    <% } %>

  </div>
</div>
